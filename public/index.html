<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>DARKVENOM SNI CHECKER – ADMIN PANEL</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #f2f6ff;
  margin: 0;
}
header {
  background: #111827;
  color: white;
  padding: 15px;
  text-align: center;
  font-size: 20px;
}
.container {
  max-width: 1100px;
  margin: auto;
  padding: 20px;
}
.card {
  background: white;
  padding: 15px;
  margin-bottom: 20px;
  border-radius: 10px;
  box-shadow: 0 5px 15px rgba(0,0,0,.1);
}
.hidden { display: none; }
table {
  width: 100%;
  border-collapse: collapse;
}
th, td {
  padding: 8px;
  border-bottom: 1px solid #ddd;
}
button {
  padding: 6px 10px;
  cursor: pointer;
}
.open { color: green; font-weight: bold; }
.closed { color: red; font-weight: bold; }
</style>
</head>

<body>

<header>DARKVENOM SNI CHECKER – ADMIN PANEL</header>

<div class="container">

<!-- LOGIN -->
<div class="card" id="loginBox">
  <h3>Admin Login</h3>
  <input id="loginUser" placeholder="Username"><br><br>
  <input id="loginPass" type="password" placeholder="Password"><br><br>
  <button onclick="login()">Login</button>
  <div id="loginMsg"></div>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="hidden">

<!-- APP CONTROL -->
<div class="card">
  <h3>App Control</h3>
  Status: <span id="appStatus"></span><br><br>
  <button onclick="toggleApp()">Toggle App (Kill-Switch)</button>
</div>

<!-- MEMBERS -->
<div class="card">
  <h3>Members</h3>
  <button onclick="addMember()">Add Member</button>
  <table>
    <thead>
      <tr>
        <th>User</th>
        <th>License</th>
        <th>Tag</th>
        <th>Days</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="membersTable"></tbody>
  </table>
</div>

<!-- ADMINS -->
<div class="card">
  <h3>Admins</h3>
  <button onclick="addAdmin()">Add Admin</button>
  <table>
    <thead>
      <tr>
        <th>User</th>
        <th>Password</th>
        <th>Role</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="adminsTable"></tbody>
  </table>
</div>

<!-- REQUESTS -->
<div class="card hidden" id="requestsCard">
  <h3>Pending Superadmin Requests</h3>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Target</th>
        <th>By</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="requestsTable"></tbody>
  </table>
</div>

</div>

<script>
/* ================= DATA ================= */

let admins = [
  {u:"DarkVenom", p:"darkvenom042", r:"OWNER"},
  {u:"PlayboyRSA", p:"rsa123", r:"VIP"},
  {u:"SuperAdmin1", p:"super123", r:"SUPER"}
];

let members = [];
let requests = [];
let appOpen = true;
let currentUser = null;

/* ================= STORAGE ================= */

function saveAll(){
  localStorage.setItem("admins", JSON.stringify(admins));
  localStorage.setItem("members", JSON.stringify(members));
  localStorage.setItem("requests", JSON.stringify(requests));
  localStorage.setItem("appOpen", JSON.stringify(appOpen));
}

function loadAll(){
  admins = JSON.parse(localStorage.getItem("admins")) || admins;
  members = JSON.parse(localStorage.getItem("members")) || [];
  requests = JSON.parse(localStorage.getItem("requests")) || [];
  let ao = JSON.parse(localStorage.getItem("appOpen"));
  appOpen = ao === null ? true : ao;
}
loadAll();

/* ================= AUTH ================= */

function login(){
  const u = loginUser.value.trim();
  const p = loginPass.value.trim();
  const found = admins.find(a => a.u === u && a.p === p);
  if(!found){
    loginMsg.innerText = "❌ Invalid credentials";
    return;
  }
  currentUser = found;
  loginBox.classList.add("hidden");
  dashboard.classList.remove("hidden");
  renderAll();
}

/* ================= ROLE HELPERS ================= */

function isOwner(){ return currentUser.r === "OWNER"; }
function isVIP(){ return currentUser.r === "VIP"; }
function isSuper(){ return currentUser.r === "SUPER"; }

/* ================= RENDER ================= */

function renderAll(){
  renderApp();
  renderMembers();
  renderAdmins();
  renderRequests();
}

function renderApp(){
  appStatus.innerHTML = appOpen
    ? "<span class='open'>OPEN</span>"
    : "<span class='closed'>CLOSED</span>";
}

function renderMembers(){
  membersTable.innerHTML = "";
  members.forEach((m,i)=>{
    membersTable.innerHTML += `
    <tr>
      <td>${m.u}</td>
      <td>${m.k}</td>
      <td>${m.tag}</td>
      <td>${m.days}</td>
      <td>
        <button onclick="extendMember(${i})">Extend</button>
        <button onclick="removeMember(${i})">Delete</button>
      </td>
    </tr>`;
  });
}

function renderAdmins(){
  adminsTable.innerHTML = "";
  admins.forEach((a,i)=>{
    let canSeePass =
      isOwner() ||
      (isVIP() && a.u !== "DarkVenom");

    adminsTable.innerHTML += `
    <tr>
      <td>${a.u}</td>
      <td>${canSeePass ? a.p : "••••••"}</td>
      <td>${a.r}</td>
      <td>
        ${canEditPassword(a) ? `<button onclick="editPassword(${i})">Edit PW</button>` : ""}
        ${canRemoveAdmin(a) ? `<button onclick="removeAdmin(${i})">Remove</button>` : ""}
      </td>
    </tr>`;
  });
}

/* ================= PASSWORD EDIT ================= */

function canEditPassword(target){
  if(isOwner()) return true;
  if(isVIP() && target.u !== "DarkVenom") return true;
  return false;
}

function editPassword(index){
  const np = prompt("New password:");
  if(!np) return;
  admins[index].p = np;
  saveAll();
  renderAdmins();
}

/* ================= MEMBERS ================= */

function generateKey(){
  return crypto.randomUUID().replace(/-/g,"").slice(0,24).toUpperCase();
}

function addMember(){
  let u = prompt("Username:");
  let tag = prompt("Tag (FREE / 5M / 1Y / VIP):");
  let days = parseInt(prompt("Days:"));
  if(!u || !days) return;
  members.push({u, tag, days, k: generateKey()});
  saveAll();
  renderMembers();
}

function extendMember(i){
  let d = parseInt(prompt("Add days:"));
  if(d){
    members[i].days += d;
    saveAll();
    renderMembers();
  }
}

function removeMember(i){
  members.splice(i,1);
  saveAll();
  renderMembers();
}

/* ================= ADMINS ================= */

function canRemoveAdmin(target){
  if(isOwner()) return true;
  if(isVIP()) return true;
  if(isSuper() && target.u !== "DarkVenom" && target.u !== "PlayboyRSA") return true;
  return false;
}

function addAdmin(){
  let u = prompt("Username:");
  let p = prompt("Password:");
  let r = prompt("Role (SUPER / VIP):");
  if(!u || !p || !r) return;

  if(isOwner() || isVIP()){
    admins.push({u,p,r});
    saveAll();
    renderAdmins();
  } else if(isSuper()){
    requests.push({type:"ADD", u, p, r, by: currentUser.u});
    saveAll();
    alert("Request sent to DarkVenom");
  }
}

function removeAdmin(i){
  let target = admins[i];
  if(isOwner() || isVIP()){
    admins.splice(i,1);
    saveAll();
    renderAdmins();
  } else if(isSuper()){
    requests.push({type:"REMOVE", u: target.u, by: currentUser.u});
    saveAll();
    alert("Request sent");
  }
}

/* ================= REQUESTS ================= */

function renderRequests(){
  if(!isOwner()){
    requestsCard.classList.add("hidden");
    return;
  }
  requestsCard.classList.remove("hidden");
  requestsTable.innerHTML = "";
  requests.forEach((r,i)=>{
    requestsTable.innerHTML += `
    <tr>
      <td>${r.type}</td>
      <td>${r.u}</td>
      <td>${r.by}</td>
      <td>
        <button onclick="approve(${i})">Approve</button>
        <button onclick="reject(${i})">Reject</button>
      </td>
    </tr>`;
  });
}

function approve(i){
  let r = requests[i];
  if(r.type === "ADD") admins.push({u:r.u,p:r.p,r:r.r});
  if(r.type === "REMOVE") admins = admins.filter(a => a.u !== r.u);
  requests.splice(i,1);
  saveAll();
  renderAll();
}

function reject(i){
  requests.splice(i,1);
  saveAll();
  renderRequests();
}

/* ================= APP CONTROL ================= */

function toggleApp(){
  if(isOwner() || isVIP()){
    appOpen = !appOpen;
    saveAll();
    renderApp();
    alert(
`APK UPDATE UNDER PROGRESS
PLEASE COME BACK FOR NEW UPDATED EXPERIENCE
FOR MORE INFO DM
t.me/D_A_R_K_V_E_N_O_M`
    );
  }
}

renderAll();
</script>
</body>
</html>
